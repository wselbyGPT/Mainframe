//* Author: William Selbuy

//ASMFLTR JOB  (001),'ASM FILTER',
//             CLASS=A,MSGCLASS=A,MSGLEVEL=(1,1),REGION=128K
//* STEP 1: BUILD AN INPUT SEQUENTIAL DATASET ON DISK
//STEP1   EXEC PGM=IEBGENER
//SYSUT1  DD *
LINE ONE FROM INPUT
LINE TWO FROM INPUT
LINE THREE FROM INPUT
/*
//SYSUT2  DD DSN=ASM.FILTER.IN,DISP=(NEW,CATLG,DELETE),
//            UNIT=SYSDA,SPACE=(TRK,(1,1)),
//            DCB=(RECFM=FB,LRECL=80,BLKSIZE=800)
//SYSPRINT DD SYSOUT=A
//SYSIN   DD DUMMY
//* ------------------------------------------------------------------
//* STEP 2: ASSEMBLE/LINK/RUN THE FILTER PROGRAM
//STEP2   EXEC ASMFCLG,PARM.ASM='OBJECT,NODECK,LIST,NOXREF'
//ASM.SYSUT1 DD UNIT=SYSDA
//ASM.SYSUT2 DD UNIT=SYSDA
//ASM.SYSUT3 DD UNIT=SYSDA
//ASM.SYSGO  DD UNIT=SYSDA
//GO.INFILE  DD DSN=ASM.FILTER.IN,DISP=OLD
//GO.OUTFILE DD DSN=ASM.FILTER.OUT,
//             DISP=(NEW,CATLG,DELETE),
//             UNIT=SYSDA,
//             SPACE=(TRK,(1,1)),
//             DCB=(RECFM=FB,LRECL=80,BLKSIZE=800)
//GO.SYSPRINT DD SYSOUT=A
//ASM.SYSIN  DD *
HELFLTR  CSECT
         USING HELFLTR,15
         SAVE  (14,12)
         LR    12,15
         USING HELFLTR,12

* OPEN INPUT (INFILE) FOR READ AND OUTPUT (OUTFILE) FOR WRITE
         OPEN  (INDCB,(INPUT),OUTDCB,(OUTPUT))

READLOOP GET   INDCB,INREC          * READ A RECORD FROM INFILE
         MVC   OUTREC(80),INREC     * COPY INPUT TO OUTPUT
         MVC   OUTREC(2),=CL2'> '   * PREFIX EACH LINE WITH "> "
         PUT   OUTDCB,OUTREC        * WRITE RECORD TO OUTFILE
         B     READLOOP             * LOOP FOR NEXT RECORD

EOF      CLOSE INDCB,OUTDCB         * END-OF-FILE HANDLER
         RETURN (14,12),RC=0

* WORK AREAS FOR QSAM RECORDS
INREC    DS    CL80
OUTREC   DS    CL80

* DCBs FOR INPUT AND OUTPUT DATASETS
INDCB    DCB   DDNAME=INFILE,DSORG=PS,MACRF=GM,
               RECFM=FB,LRECL=80,BLKSIZE=800,EODAD=EOF
OUTDCB   DCB   DDNAME=OUTFILE,DSORG=PS,MACRF=PM,
               RECFM=FB,LRECL=80,BLKSIZE=800

         END   HELFLTR
/*
//* ------------------------------------------------------------------
//* STEP 3: PRINT THE OUTPUT DATASET SO YOU CAN SEE IT IN PRT00E
//STEP3   EXEC PGM=IEBGENER
//SYSUT1  DD DSN=ASM.FILTER.OUT,DISP=OLD
//SYSUT2  DD SYSOUT=A
//SYSPRINT DD SYSOUT=A
//SYSIN   DD DUMMY
//
